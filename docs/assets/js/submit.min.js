var token,username,unauthorized=!0;async function resizeTextArea(e){$(e).css("height","auto"),$(e).css("height",e.scrollHeight)}async function submitPost(){var e=$("#title").val(),t=$("#body").val();if(e.length)if(t.length)if(usnm=await get_user(),usnm){if(username=usnm.login,!await check_repo())return Cookies.set("draft-title",e),Cookies.set("draft-body",t),void window.location.replace("/setup.html");if(await create_issue(e,t))return window.location.replace("/");alert("Can't submit post now, please check again later.")}else window.location.replace("/401.html");else $("#body").focus();else $("#title").focus()}function check_repo(){return fetch("https://api.github.com/repos/"+username+"/"+username,{method:"GET"}).then((e=>!!e.ok))}function create_issue(e,t){return fetch("https://api.github.com/repos/"+username+"/"+username+"/issues",{method:"POST",headers:{Accept:"application/vnd.github+json",Authorization:`token ${token}`},body:JSON.stringify({title:"#gitlounge "+e,body:t})}).then((e=>!!e.ok))}function get_user(){return fetch("https://api.github.com/user",{method:"GET",headers:{Accept:"application/vnd.github+json",Authorization:`token ${token}`}}).then((e=>!!e.ok&&e.json()))}Cookies.get("token")&&($("#github-login-button").addClass("visually-hidden"),$("#exit-button").removeClass("visually-hidden"),token=Cookies.get("token"),unauthorized=!1),unauthorized&&window.location.replace("/");