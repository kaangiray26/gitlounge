var issue,token="";const regex=/<!--([^)]+)-->/;var example_post=$(".post").clone().removeClass("visually-hidden"),example_comment=$(".comment").clone().removeClass("visually-hidden");async function load_post(){var e=window.location.search;if(e&&(issue=e.split("?issue=")[1])){var t=await get_post();if(t.hasOwnProperty("url")){if(displayPost(t),t.comments>0)(await get_post_comments()).forEach(displayComment)}else $("#no-result").removeClass("visually-hidden")}}async function displayPost(e){let t=$(example_post).clone(),o=e.body.match(regex);o&&$(t).find(".post-image").attr("src",o[1]),$(t).removeClass("visually-hidden"),$(t).find(".post-title").text(e.title.substring(10)),$(t).find(".post-body").html(await get_markdown_render(e.body)),$(t).find(".post-link").attr("href","post.html?issue="+e.url.split("https://api.github.com/repos/")[1]),$(t).find(".upvote-button").attr("url",e.url+"/reactions"),$(t).find(".downvote-button").attr("url",e.url+"/reactions"),$(t).find(".post-user").attr("href","user.html?user="+e.user.login),$(t).find(".post-user").text(e.user.login),$(t).find(".post-user-image").attr("src",e.user.avatar_url),e.reactions["+1"]&&($(t).find(".post-upvote").text("👍 "+e.reactions["+1"]),$(t).find(".post-upvote").removeClass("visually-hidden")),e.reactions[-1]&&($(t).find(".post-downvote").text("👎 "+e.reactions[-1]),$(t).find(".post-downvote").removeClass("visually-hidden")),e.reactions.laugh&&($(t).find(".post-laugh").text("😆 "+e.reactions.laugh),$(t).find(".post-laugh").removeClass("visually-hidden")),e.reactions.hooray&&($(t).find(".post-hooray").text("🎉 "+e.reactions.hooray),$(t).find(".post-hooray").removeClass("visually-hidden")),e.reactions.confused&&($(t).find(".post-confused").text("😕 "+e.reactions.confused),$(t).find(".post-confused").removeClass("visually-hidden")),e.reactions.heart&&($(t).find(".post-heart").text("❤️ "+e.reactions.heart),$(t).find(".post-heart").removeClass("visually-hidden")),e.reactions.rocket&&($(t).find(".post-rocket").text("🚀 "+e.reactions.rocket),$(t).find(".post-rocket").removeClass("visually-hidden")),e.reactions.eyes&&($(t).find(".post-eyes").text("👀 "+e.reactions.eyes),$(t).find(".post-eyes").removeClass("visually-hidden")),$("#post-feed").append(t)}async function displayComment(e){let t=$(example_comment).clone();$(t).removeClass("visually-hidden"),$(t).find(".comment-body").html(await get_markdown_render(e.body)),$(t).find(".comment-user").attr("href","user.html?user="+e.user.login),$(t).find(".comment-user").text(e.user.login),$(t).find(".comment-user-image").attr("src",e.user.avatar_url),e.reactions["+1"]&&($(t).find(".comment-upvote").text("👍 "+e.reactions["+1"]),$(t).find(".comment-upvote").removeClass("visually-hidden")),e.reactions[-1]&&($(t).find(".comment-downvote").text("👎 "+e.reactions[-1]),$(t).find(".comment-downvote").removeClass("visually-hidden")),e.reactions.laugh&&($(t).find(".comment-laugh").text("😆 "+e.reactions.laugh),$(t).find(".comment-laugh").removeClass("visually-hidden")),e.reactions.hooray&&($(t).find(".comment-hooray").text("🎉 "+e.reactions.hooray),$(t).find(".comment-hooray").removeClass("visually-hidden")),e.reactions.confused&&($(t).find(".comment-confused").text("😕 "+e.reactions.confused),$(t).find(".comment-confused").removeClass("visually-hidden")),e.reactions.heart&&($(t).find(".comment-heart").text("❤️ "+e.reactions.heart),$(t).find(".comment-heart").removeClass("visually-hidden")),e.reactions.rocket&&($(t).find(".comment-rocket").text("🚀 "+e.reactions.rocket),$(t).find(".comment-rocket").removeClass("visually-hidden")),e.reactions.eyes&&($(t).find(".comment-eyes").text("👀 "+e.reactions.eyes),$(t).find(".comment-eyes").removeClass("visually-hidden")),$("#all-feed").append(t)}function get_post(){return fetch("https://api.github.com/repos/"+issue,{method:"GET",headers:{Accept:"application/vnd.github+json",Authorization:`token ${token}`}}).then((e=>e.json()))}function get_post_comments(){return fetch("https://api.github.com/repos/"+issue+"/comments",{method:"GET",headers:{Accept:"application/vnd.github+json",Authorization:`token ${token}`}}).then((e=>e.json()))}function get_markdown_render(e){return fetch("https://api.github.com/markdown",{method:"POST",headers:{Accept:"application/vnd.github+json",Authorization:`token ${token}`},body:JSON.stringify({text:e})}).then((e=>!!e.ok&&e.text()))}Cookies.get("token")&&($("#github-login-button").addClass("visually-hidden"),$("#exit-button").removeClass("visually-hidden"),token=Cookies.get("token")),load_post();